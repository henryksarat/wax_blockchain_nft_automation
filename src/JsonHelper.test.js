import {goldman_reward_metadata, farmingtales_reward_metadata, example} from "./JsonHelper.js";

test('example return of true', () => {
	expect(example('not used')).toBe(true)
})

test('metadata is returned from the complex object', () => {
	var goldman_success_return = "{\"transaction_id\":\"d584c7a543556fdf39bbe452f9564150db6a28c99d080adbcbe285ba8f536737\",\"processed\":{\"id\":\"d584c7a543556fdf39bbe452f9564150db6a28c99d080adbcbe285ba8f536737\",\"block_num\":167660860,\"block_time\":\"2022-02-19T16:13:00.500\",\"producer_block_id\":null,\"receipt\":{\"status\":\"executed\",\"cpu_usage_us\":1860,\"net_usage_words\":15},\"elapsed\":1860,\"net_usage\":120,\"scheduled\":false,\"action_traces\":[{\"action_ordinal\":1,\"creator_action_ordinal\":0,\"closest_unnotified_ancestor_action_ordinal\":0,\"receipt\":{\"receiver\":\"goldmandgame\",\"act_digest\":\"449d6a3338bfcb08c39cc4c7e9534de4af21e7431c0c2ca593a3bea1200ab79a\",\"global_sequence\":\"39218965225\",\"recv_sequence\":4436302,\"auth_sequence\":[[\"ggu2m.c.wam\",372]],\"code_sequence\":197,\"abi_sequence\":189},\"receiver\":\"goldmandgame\",\"act\":{\"account\":\"goldmandgame\",\"name\":\"mine\",\"authorization\":[{\"actor\":\"ggu2m.c.wam\",\"permission\":\"active\"}],\"data\":{\"miner\":\"ggu2m.c.wam\"},\"hex_data\":\"00a4e10001293463\"},\"context_free\":false,\"elapsed\":1477,\"console\":\"\",\"trx_id\":\"d584c7a543556fdf39bbe452f9564150db6a28c99d080adbcbe285ba8f536737\",\"block_num\":167660860,\"block_time\":\"2022-02-19T16:13:00.500\",\"producer_block_id\":null,\"account_ram_deltas\":[],\"except\":null,\"error_code\":null,\"inline_traces\":[{\"action_ordinal\":2,\"creator_action_ordinal\":1,\"closest_unnotified_ancestor_action_ordinal\":1,\"receipt\":{\"receiver\":\"goldmandgame\",\"act_digest\":\"427287bb359c1d91d8de3a18545d01bf1689456191c07f24fd21d6940eeb0656\",\"global_sequence\":\"39218965226\",\"recv_sequence\":4436303,\"auth_sequence\":[[\"goldmandgame\",2678143]],\"code_sequence\":197,\"abi_sequence\":189},\"receiver\":\"goldmandgame\",\"act\":{\"account\":\"goldmandgame\",\"name\":\"logmine\",\"authorization\":[{\"actor\":\"goldmandgame\",\"permission\":\"active\"}],\"data\":{\"miner\":\"ggu2m.c.wam\",\"consume_gme\":\"0.0000 GME\",\"consume_gmm\":\"3.0120 GMM\",\"consume_gmf\":\"7.7880 GMF\",\"reward\":\"12.3219 GME\",\"reward_gmd\":\"0.0456 GMD\"},\"hex_data\":\"00a4e10001293463000000000000000004474d4500000000a87500000000000004474d4d00000000383001000000000004474d460000000053e101000000000004474d4500000000c80100000000000004474d4400000000\"},\"context_free\":false,\"elapsed\":27,\"console\":\"\",\"trx_id\":\"d584c7a543556fdf39bbe452f9564150db6a28c99d080adbcbe285ba8f536737\",\"block_num\":167660860,\"block_time\":\"2022-02-19T16:13:00.500\",\"producer_block_id\":null,\"account_ram_deltas\":[],\"except\":null,\"error_code\":null,\"inline_traces\":[]}]}],\"account_ram_delta\":null,\"except\":null,\"error_code\":null}}"
	var goldman_object = JSON.parse(goldman_success_return)

	var expected_result = {"consume_gme": "0.0000 GME", "consume_gmf": "7.7880 GMF", "consume_gmm": "3.0120 GMM", "miner": "ggu2m.c.wam", "reward": "12.3219 GME", "reward_gmd": "0.0456 GMD"}
	expect(goldman_reward_metadata(goldman_object)).toStrictEqual(expected_result)
})

test('farming tales has value in return object', () => {
	var harvest_response = {"transaction_id":"797f735e16a14dcc94de1546d04789d98a97943b8781b3bd277d0e8918aafc3d","processed":{"id":"797f735e16a14dcc94de1546d04789d98a97943b8781b3bd277d0e8918aafc3d","block_num":168256718,"block_time":"2022-02-23T02:58:45.000","producer_block_id":null,"receipt":{"status":"executed","cpu_usage_us":206,"net_usage_words":16},"elapsed":206,"net_usage":128,"scheduled":false,"action_traces":[{"action_ordinal":1,"creator_action_ordinal":0,"closest_unnotified_ancestor_action_ordinal":0,"receipt":{"receiver":"farminggames","act_digest":"9b241842254a7a4508396b8fd231099eb3c59ea55517763695252efa0884b4c6","global_sequence":"39547360085","recv_sequence":36510247,"auth_sequence":[["gqgb.wam",1873]],"code_sequence":53,"abi_sequence":20},"receiver":"farminggames","act":{"account":"farminggames","name":"harvestanim","authorization":[{"actor":"gqgb.wam","permission":"active"}],"data":{"account":"gqgb.wam","asset_id":"1099571862183"},"hex_data":"000000d270709865a71a970300010000"},"context_free":false,"elapsed":65,"console":"","trx_id":"797f735e16a14dcc94de1546d04789d98a97943b8781b3bd277d0e8918aafc3d","block_num":168256718,"block_time":"2022-02-23T02:58:45.000","producer_block_id":null,"account_ram_deltas":[],"except":null,"error_code":null,"inline_traces":[]}],"account_ram_delta":null,"except":null,"error_code":null}}

	var expected_result = 1873

	expect(farmingtales_reward_metadata(harvest_response)).toStrictEqual(expected_result)
})